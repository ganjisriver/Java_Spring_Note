# 시큐리티 권한 설정 방식



## 1. 선언적 방식

- URL 단위 
  
  - 아래 코드의 뜻은 "/users"라는 uri로 들어온 코드에서 USER 라는 권한을 가진 사람만 해당 uri로 들어올 수 있다는 의미이다. 

```java
http.antMatchers("/users/**").hasRole("USER")
```

- Method 단위
  
  - "@PreAuthorize" 어노테이션은 메소드 호출 이전에 인가 검사를 수행하여 해당 메소드에 대한 접근 권한이 있는지 확인해준다. 이 경우, "USER" 역할을 가진 사용자만 해당 메소드를 호출할 수 있다.

```java
@PreAuthorize("hasRole('USER')")
public void user() {~}
```



- 추가적으로, "USER"라는 역할을 특정 유저들에게 할당하는 것은 일반적으로 스프링단에서 DB에 넣어 추가해주는 것이 일반적이다. 예를 들어, User라는 Entitiy에 Role이라는 Column을 추가해주는 방식이고, 유저에 따라 역할을 부여하는 코드를 넣어주면 된다. 아래는 예시코드다.

```java
@Entity
@Table(name = "users")
public class User {

    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;

    @Column(nullable = false, unique = true)
    private String username;

    @Column(nullable = false)
    private String password;

    @Column(nullable = false)
    private String email;

    @Column(nullable = false)
    private boolean enabled;

    @Column(nullable = false)
    private String role; # 일반적으로 String대신 Enum객체를 하나 만들어서
                         # 그 안에 USER, ADMIN 등으로 만들어 주는게 일반적인 것 같다.

    // getter, setter, 생성자 등 생략

}
```


